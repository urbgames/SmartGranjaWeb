<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/vis.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/style.css">
<link rel="stylesheet" type="text/css" href="css/menu.css">
<link rel="stylesheet" href="css/bootstrap.min.css">
<link rel="stylesheet" href="css/vis.min.css">

<script>

		var localServer="http://localhost:8080/SmartGranjaWeb3";
		var DOTstring = "";
		var tree;

		$(document).ready(function() {

			$("input:checkbox:not(#allCheck)").click(function(event){
					loadPanelResult();
				});

				$("#allCheck").click(function(event){
					$("input:checkbox:not(#allCheck)").prop("checked",$("#allCheck").prop("checked"));
					loadPanelResult();
					});

		});

		function loadPanelResult(){

			$("#panelResulTree").empty();
			$("input:checkbox:not(#allCheck)").map(function( val, i ) {
				if (i.checked){
					valor = tree[i.id] == null ? "": tree[i.id]
					$("#panelResulTree").append($("#"+i.id).parent()[0].innerText+": " + valor + "\n");
				}
			});

		}

		function loadTree(){
			$.ajax({
				type : "GET",
				crossDomain: true,
				async: false,
				url : localServer+"/getarvore",
				success : function(data) {
					tree = data;
					creatGraphTree(data.treeGraph);
					loadPanelResult();
				},
				error : function(data) {
					console.log("Erro ao obter árvore de decisão");
				}
			});
		}

		function creatGraphTree(DOTstring){

			DOTstring = 'digraph J48Tree {N0 [label="umidade" ]N0->N1 [label="<= 52"]N1 [label="alta (58.0/15.0)" shape=box style=filled ]N0->N2 [label="> 52"]N2 [label="temperatura" ]N2->N3 [label="<= 23.5"]N3 [label="alta (39.0/8.0)" shape=box style=filled ]N2->N4 [label="> 23.5"]N4 [label="temperatura" ]N4->N5 [label="<= 25"]N5 [label="umidade" ]N5->N6 [label="<= 54.5"]N6 [label="baixa (285.0/47.0)" shape=box style=filled ]N5->N7 [label="> 54.5"]N7 [label="alta (28.0/7.0)" shape=box style=filled ]N4->N8 [label="> 25"]N8 [label="alta (40.0/10.0)" shape=box style=filled ]}'
			console.log(DOTstring);
			var parsedData = vis.network.convertDot(DOTstring);
			console.log(parsedData);
			var data = {
				nodes: parsedData.nodes,
				edges: parsedData.edges
			}
			var container = document.getElementById('mynetwork');
			var options = {
				layout: {
					hierarchical: {
						sortMethod:'directed'
					}
						}
			};
			var network = new vis.Network(container, data, options);

		}
</script>


</head>
<body>


	<nav class="navbar navbar-default">
  	<div class="navbar-header">
        <a class="navbar-brand">Smart Granja API</a>
      </div>
  	  <div class="container">
  		<div class="collapse navbar-collapse">
  		  <ul class="nav navbar-nav">
  			<li ><a href="index.html">Home</a></li>
  			<li><a href="relatorioDiario.html">Relatório diário</a></li>
  			<li class="dropdown">
  				<a class="dropdown-toggle" data-toggle="dropdown" href="#">Dashboard
  				<span class="caret"></span></a>
  				<ul class="dropdown-menu">
  				  <li><a href="graphics.html">Overview</a></li>
  				  <li><a href="graphics2.html">Leitura sensores</a></li>
  				</ul>
  			  </li>
          <li class="active"><a href="treegenerator.html">Computação</a></li>
  			</ul>
  		</div>
  	  </div>
	</nav>

	<div class="container">
		<div class="row">
			<div class="col-md-3">
				<div class="panel panel-primary">
				  <div class="panel-heading">Atributos da árvore de decição</div>
						<div class="panel-body">
							<div class="checkbox">
						    <label><input id="allCheck" type="checkbox">#</label>
						  </div>
						  <div class="checkbox">
						    <label><input id="errorRate" type="checkbox">Error rate</label>
						  </div>
							<div class="checkbox">
						    <label><input id="revision" type="checkbox">Revision</label>
						  </div>
							<div class="checkbox">
						    <label><input id="kappa" type="checkbox">Kappa</label>
						  </div>
							<div class="checkbox">
						    <label><input id="kBInformation" type="checkbox">KB information</label>
						  </div>
							<div class="checkbox">
						    <label><input id="kbRelativeInformation" type="checkbox">KB relative information</label>
						  </div>
							<div class="checkbox">
						    <label><input id="kBMeanInformation" type="checkbox">KB mean information</label>
						  </div>
							<div class="checkbox">
						    <label><input id="meanAbsoluteError" type="checkbox">Mean absolute error</label>
						  </div>
							<div class="checkbox">
						    <label><input id="rootMeanPriorSquaredError" type="checkbox">Root prior square error</label>
						  </div>
							<div class="checkbox">
						    <label><input id="classDetails" type="checkbox">Class detail</label>
						  </div>
							<div class="checkbox">
						    <label><input id="cumulativeMarginDistribution" type="checkbox">Cumulative margin distribuition</label>
						  </div>
							<div class="checkbox">
						    <label><input id="matrix" type="checkbox">Matrix</label>
						  </div>
							<div class="checkbox">
						    <label><input id="summary" type="checkbox">Summary</label>
						  </div>
							<div class="checkbox">
						    <label><input id="weightedAreaUnderROC" type="checkbox">Weighted area under PRC</label>
						  </div>
							<div class="checkbox">
						    <label><input id="weightedFMeasure" type="checkbox">Weighted f-measure</label>
						  </div>
							<div class="checkbox">
						    <label><input id="tree" type="checkbox">Tree</label>
						  </div>
							<div class="checkbox">
						    <label><input id="treeGraph" type="checkbox">Tree DOT</label>
						  </div>
						  <button onClick="loadTree()" class="btn btn-primary">Gerar árvore</button>
						</div>
					</div>
			</div>
			<div class="col-md-9">
				<div class="panel panel-primary">
				  <div class="panel-heading">Resultado</div>
						<div class="panel-body">
							<textarea class="form-control" rows="5" id="panelResulTree"></textarea>
							<div id="mynetwork"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
